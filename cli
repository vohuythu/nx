#!/bin/bash

# Cài đặt Homebrew (chỉ áp dụng cho macOS)
if [[ "$OSTYPE" == "darwin"* ]]; then
  echo "Cài đặt Homebrew..."
  /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
fi

# Cài đặt Rust
echo "Cài đặt Rust..."
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y
source $HOME/.cargo/env

# Cài đặt cmake (nếu sử dụng Homebrew)
if command -v brew &>/dev/null; then
  echo "Cài đặt cmake bằng Homebrew..."
  brew install cmake
fi

# Thêm target riscv32i-unknown-none-elf cho Rust
echo "Thêm target riscv32i-unknown-none-elf cho Rust..."
rustup target add riscv32i-unknown-none-elf

# Cài đặt Nexus CLI
echo "Cài đặt Nexus CLI..."
curl https://cli.nexus.xyz/ | sh

echo "Hoàn tất cài đặt. Chạy 'nexus-network start' để bắt đầu."
