FROM ubuntu:latest

# Cập nhật hệ thống và cài đặt các gói cần thiết
RUN apt update && apt install -y build-essential pkg-config libssl-dev git-all \
    autoconf automake libtool curl make g++ unzip

# Cài đặt Protobuf
RUN git clone --depth=1 --branch=v21.12 https://github.com/protocolbuffers/protobuf.git && \
    cd protobuf && \
    git submodule update --init --recursive && \
    ./autogen.sh && \
    ./configure && \
    make -j$(nproc) && \
    make install && \
    ldconfig && \
    cd .. && rm -rf protobuf

# Cài đặt Rust
RUN curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y && \
    source $HOME/.cargo/env && \
    rustup target add riscv32i-unknown-none-elf

# Cài đặt Nexus CLI
RUN curl https://cli.nexus.xyz/ | sh

# Chạy Nexus Node
CMD ["~/.nexus/network-api/clients/cli/target/release/nexus-network"]
